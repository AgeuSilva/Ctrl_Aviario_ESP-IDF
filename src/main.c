#include "esp_system.h"
#include "esp_event_loop.h"
#include "nvs_flash.h"
#include "esp_log.h"

/*=============================================================================================================================
    Init Includes Files FreeRTOS
=============================================================================================================================*/
#include "freertos/FreeRTOS.h"
/*=============================================================================================================================
    End Includes Files FreeRTOS
=============================================================================================================================*/

/*=============================================================================================================================
    Init Includes Files App's
=============================================================================================================================*/
#include "App_Azure.h"
#include "App_ControlSaidas.h"
#include "App_Display.h"
#include "App_SensorDHT.h"
#include "App_Supervisorio.h"
#include "App_Teclado.h"
/*=============================================================================================================================
    End Includes Files App's
=============================================================================================================================*/

/*=============================================================================================================================
    Init Main Fonction
=============================================================================================================================*/
void app_main(void) 
{
    //Initialize NVS
    esp_err_t ret = nvs_flash_init();
    if (ret == ESP_ERR_NVS_NO_FREE_PAGES)
    {
        ESP_ERROR_CHECK(nvs_flash_erase());
        ret = nvs_flash_init();
    }
    ESP_ERROR_CHECK(ret);

    esp_log_level_set("*", ESP_LOG_INFO);

    vConfigSensorDHT();
    vConfigControlSaidas();
    vConfigDisplay();
    vConfigTeclado();
    vConfigSupervisorio();
    vConfigAzure();
    
    while (true)
    {
        vTaskDelay(pdMS_TO_TICKS(10)); /* Delay de 3 segundos */
    }
}
/*=============================================================================================================================
    End Main Fonction
=============================================================================================================================*/